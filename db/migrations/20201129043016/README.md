# Migration `20201129043016`

This migration has been generated by James Johnson at 11/28/2020, 11:30:16 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "Card" DROP CONSTRAINT "Card_eventId_fkey"

ALTER TABLE "Card" DROP COLUMN "eventId",
ADD COLUMN     "eventUUID" TEXT NOT NULL

CREATE UNIQUE INDEX "Card.uuid_unique" ON "Card"("uuid")

CREATE UNIQUE INDEX "Event.uuid_unique" ON "Event"("uuid")

ALTER TABLE "Card" ADD FOREIGN KEY("eventUUID")REFERENCES "Event"("uuid") ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20201129042529..20201129043016
--- datamodel.dml
+++ datamodel.dml
@@ -3,9 +3,9 @@
 }
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 model Card {
   id        Int      @id @default(autoincrement())
@@ -13,18 +13,18 @@
   author    String
   title     String
   content   String
   picture   String?
-  uuid      String
-  eventId   Int
-  event     Event    @relation(fields: [eventId], references: [id])
+  uuid      String  @unique
+  eventUUID String
+  event     Event    @relation(fields: [eventUUID], references: [uuid])
 }
 model Event {
   id        Int      @id @default(autoincrement())
   createdAt DateTime @default(now())
   name      String
   creator   String
   recipient String
-  uuid      String
+  uuid      String   @unique
   cards     Card[]
 }
```


